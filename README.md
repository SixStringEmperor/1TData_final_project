# 1TData_final_project
Проект № 5
Служба такси.

```Все операции должны считаться локально.
Данные - Служба такси 

Есть таблица, состоящая из поездок такси в Нью-Йорке.\
Поле - Описание\
VendorId - ИД компании\
Trep_pickup_datetime - Время и дата, когда пассажир сел в такси\
Trep_dropoff_datetime - Время и дата, когда пассажир вышел из такси\
Passanger_count - Количество пассажиров\
Trip_distance -Пройденное расстояние\
Ratecodeid -Код скорости\
Store_and_fwd_flag - Флаг, отвечающий за сохранение записи поездки перед ее отправкой поставщику\
PulocationId - Широта, где была начата поездка\
Dolocationid - Долгота, где была начата поездка\
Payment_type - Тип оплаты\
Fare_amount - Стоимость поездки\
Mta_tax - Комиссия автопарка\
Tip_amount -Чаевые\
Tools_amount - Оплата за платные дороги\
Improvement_surchange - Доплата за страховку\
Total_amount - Полная стоимость поездки\
Congestion_surchange -Дополнительный сбор\

Необходимо, используя таблицу поездок для каждого дня, рассчитать процент поездок по количеству человек в машине (без пассажиров, 1, 2, 3, 4 и более пассажиров). По итогу должна получиться таблица (parquet) с колонками date, percentage_zero, percentage_1p, percentage_2p, percentage_3p, percentage_4p_plus. Технологический стек — sql, scala (что-то одно). 
Также добавить столбцы к предыдущим результатам с самой дорогой и самой дешевой поездкой для каждой группы.\

Дополнительно: также провести аналитику и построить график на тему «Как пройденное расстояние и количество пассажиров влияет на чаевые» в любом удобном инструменте.
```

-----------------

### Задача 1:
```Необходимо, используя таблицу поездок для каждого дня, рассчитать процент поездок по количеству человек в машине (без пассажиров, 1, 2, 3, 4 и более пассажиров). По итогу должна получиться таблица (parquet) c колонками date, percentage_zero, percentage_1p, percentage_2p, percentage_3p, percentage_4p_plus. Также добавить столбцы к предыдущим результатам с самой дорогой и самой дешевой поездкой для каждой группы.```
### Решение:
Анализ данных осуществлялся с помощью Pandas и PySpark.\
Данные были очищенны от пустых значений, а также выбросов \
Были обнаруженые данные с отрицательными значениями, которые свидетельствовали о том, что поездки были отменены. Время поездок минимальное, кроме этого, были аналогичные записи с положительным значением\
### Задача2:
```Провести аналитику и построить график на тему «Как пройденное расстояние и количество пассажиров влияет на чаевые»```
### Решение:
на диаграмме видно, что видно небольшое кол-во выбросов. Кроме того видно,что есть зависомотсть между параметрами и размер часовых клиенты оценивают соразмерно расстоянию поездки\
![image](https://github.com/SixStringEmperor/1TData_final_project/blob/main/1.png)
Среднее значение пройдено расстояния и чаевых:\
![image](https://github.com/SixStringEmperor/1TData_final_project/blob/main/3.png)

При анализи построили тепловую карту\
![image](https://github.com/SixStringEmperor/1TData_final_project/blob/main/2.png)
На основании полученных данных можно увидеть, что с увеличением пройденного расстояния увеличивается размер чаевых при этом наибольший размер чаевых пассажиры склонных оставлять на дистанции 15-20 километров у всех груп пассажиров, кроме группы из 4х пассажиров.
--больше всего чаевых у группы: 1, 5, 6
--меньше всего 4
